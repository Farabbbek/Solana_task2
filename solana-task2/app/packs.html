<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÅ –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–∞–∫–æ–≤ Music NFT</title>
    <link rel="stylesheet" href="styles/style.css">
    <link rel="stylesheet" href="styles/rarity.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>

<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <i class="fas fa-music"></i>
                <span>Music NFT</span>
            </div>
            <div class="nav-menu">
                <a href="index.html" class="nav-link">–ì–ª–∞–≤–Ω–∞—è</a>
                <a href="create.html" class="nav-link">–°–æ–∑–¥–∞—Ç—å NFT</a>
                <a href="packs.html" class="nav-link active">–ü–∞–∫–∏</a>
                <a href="marketplace.html" class="nav-link">–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å</a>
                <a href="gallery.html" class="nav-link">–ì–∞–ª–µ—Ä–µ—è</a>
            </div>
            <div class="wallet-section">
                <button id="connect-wallet" class="wallet-btn">
                    <i class="fas fa-wallet"></i>
                    –ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ—à–µ–ª–µ–∫
                </button>
                <div id="wallet-info" class="wallet-info" style="display: none;">
                    <span id="wallet-address"></span>
                    <button id="disconnect-wallet" class="disconnect-btn">√ó</button>
                </div>
            </div>
        </div>
    </nav>

    <main class="packs-page">
        <div class="container">
            <div class="page-header">
                <h1><i class="fas fa-box-open"></i> –ö–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–Ω—ã–µ –ø–∞–∫–∏</h1>
                <p>–ü–æ–∫—É–ø–∞–π –∞–ª—å–±–æ–º—ã –∏ –ø–æ–ª—É—á–∞–π —Å–ª—É—á–∞–π–Ω—ã–µ NFT —Å —Ä–∞–∑–Ω–æ–π —Ä–µ–¥–∫–æ—Å—Ç—å—é!</p>
                <div class="stats-bar">
                    <div class="stat">
                        <span id="total-packs-sold">0</span>
                        <small>–ü–∞–∫–æ–≤ –ø—Ä–æ–¥–∞–Ω–æ</small>
                    </div>
                    <div class="stat">
                        <span id="user-collection-size">0</span>
                        <small>–í –≤–∞—à–µ–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏</small>
                    </div>
                    <div class="stat">
                        <span id="collection-value">0.000</span>
                        <small>SOL —Å—Ç–æ–∏–º–æ—Å—Ç—å</small>
                    </div>
                </div>
            </div>

            <div class="rarity-legend">
                <h3>–†–µ–¥–∫–æ—Å—Ç—å NFT:</h3>
                <div class="rarity-items">
                    <div class="rarity-item common">
                        <div class="rarity-color"></div>
                        <span>–û–±—ã—á–Ω—ã–π (60%)</span>
                    </div>
                    <div class="rarity-item rare">
                        <div class="rarity-color"></div>
                        <span>–†–µ–¥–∫–∏–π (25%)</span>
                    </div>
                    <div class="rarity-item epic">
                        <div class="rarity-color"></div>
                        <span>–≠–ø–∏—á–µ—Å–∫–∏–π (10%)</span>
                    </div>
                    <div class="rarity-item legendary">
                        <div class="rarity-color"></div>
                        <span>–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π (4%)</span>
                    </div>
                    <div class="rarity-item mythic">
                        <div class="rarity-color"></div>
                        <span>–ú–∏—Ñ–∏—á–µ—Å–∫–∏–π (1%)</span>
                    </div>
                </div>
            </div>

            <div class="packs-grid">
                <!-- –°—Ç–∞—Ä—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä -->
                <div class="pack-item starter-pack">
                    <div class="pack-visual">
                        <div class="pack-icon">üéµ</div>
                        <div class="pack-glow"></div>
                    </div>
                    <div class="pack-info">
                        <h3>Starter Pack</h3>
                        <p class="pack-description">–ò–¥–µ–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ä—Ç –¥–ª—è –Ω–æ–≤—ã—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä–æ–≤</p>

                        <div class="pack-contents">
                            <div class="pack-stat">
                                <i class="fas fa-coins"></i>
                                <span>5 NFT</span>
                            </div>
                            <div class="pack-stat">
                                <i class="fas fa-gem"></i>
                                <span>0.1 SOL</span>
                            </div>
                        </div>

                        <div class="rarity-chances">
                            <div class="chance-item">
                                <div class="chance-bar common" style="width: 70%"></div>
                                <span>–û–±—ã—á–Ω—ã–π 70%</span>
                            </div>
                            <div class="chance-item">
                                <div class="chance-bar rare" style="width: 25%"></div>
                                <span>–†–µ–¥–∫–∏–π 25%</span>
                            </div>
                            <div class="chance-item">
                                <div class="chance-bar epic" style="width: 5%"></div>
                                <span>–≠–ø–∏—á–µ—Å–∫–∏–π 5%</span>
                            </div>
                        </div>

                        <button class="btn btn-primary pack-buy-btn" onclick="buyPack('starter')">
                            <i class="fas fa-shopping-cart"></i>
                            –ö—É–ø–∏—Ç—å –∑–∞ 0.1 SOL
                        </button>
                    </div>
                </div>

                <!-- –ü—Ä–µ–º–∏—É–º pack -->
                <div class="pack-item premium-pack">
                    <div class="pack-visual">
                        <div class="pack-icon">üé∏</div>
                        <div class="pack-glow premium"></div>
                    </div>
                    <div class="pack-info">
                        <h3>Premium Pack</h3>
                        <p class="pack-description">–ë–æ–ª—å—à–µ NFT –∏ —à–∞–Ω—Å –Ω–∞ –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–µ</p>

                        <div class="pack-contents">
                            <div class="pack-stat">
                                <i class="fas fa-coins"></i>
                                <span>10 NFT</span>
                            </div>
                            <div class="pack-stat">
                                <i class="fas fa-gem"></i>
                                <span>0.5 SOL</span>
                            </div>
                        </div>

                        <div class="rarity-chances">
                            <div class="chance-item">
                                <div class="chance-bar common" style="width: 50%"></div>
                                <span>–û–±—ã—á–Ω—ã–π 50%</span>
                            </div>
                            <div class="chance-item">
                                <div class="chance-bar rare" style="width: 30%"></div>
                                <span>–†–µ–¥–∫–∏–π 30%</span>
                            </div>
                            <div class="chance-item">
                                <div class="chance-bar epic" style="width: 15%"></div>
                                <span>–≠–ø–∏—á–µ—Å–∫–∏–π 15%</span>
                            </div>
                            <div class="chance-item">
                                <div class="chance-bar legendary" style="width: 5%"></div>
                                <span>–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π 5%</span>
                            </div>
                        </div>

                        <button class="btn btn-primary pack-buy-btn premium" onclick="buyPack('premium')">
                            <i class="fas fa-star"></i>
                            –ö—É–ø–∏—Ç—å –∑–∞ 0.5 SOL
                        </button>
                    </div>
                </div>

                <!-- –ú–∏—Ñ–∏—á–µ—Å–∫–∞—è pack -->
                <div class="pack-item mythic-pack">
                    <div class="pack-visual">
                        <div class="pack-icon">üåü</div>
                        <div class="pack-glow mythic"></div>
                        <div class="mythic-particles">
                            <div class="particle"></div>
                            <div class="particle"></div>
                            <div class="particle"></div>
                        </div>
                    </div>
                    <div class="pack-info">
                        <h3>Mythic Pack</h3>
                        <p class="pack-description">–≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ NFT –≤—ã—Å—à–µ–≥–æ —É—Ä–æ–≤–Ω—è</p>

                        <div class="pack-contents">
                            <div class="pack-stat">
                                <i class="fas fa-coins"></i>
                                <span>3 NFT</span>
                            </div>
                            <div class="pack-stat">
                                <i class="fas fa-gem"></i>
                                <span>2.0 SOL</span>
                            </div>
                        </div>

                        <div class="rarity-chances">
                            <div class="chance-item">
                                <div class="chance-bar epic" style="width: 40%"></div>
                                <span>–≠–ø–∏—á–µ—Å–∫–∏–π 40%</span>
                            </div>
                            <div class="chance-item">
                                <div class="chance-bar legendary" style="width: 50%"></div>
                                <span>–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π 50%</span>
                            </div>
                            <div class="chance-item">
                                <div class="chance-bar mythic" style="width: 10%"></div>
                                <span>–ú–∏—Ñ–∏—á–µ—Å–∫–∏–π 10%</span>
                            </div>
                        </div>

                        <button class="btn btn-primary pack-buy-btn mythic" onclick="buyPack('mythic')">
                            <i class="fas fa-crown"></i>
                            –ö—É–ø–∏—Ç—å –∑–∞ 2.0 SOL
                        </button>
                    </div>
                </div>
            </div>

            <div class="quick-actions">
                <button class="btn btn-secondary" onclick="window.location.href='gallery.html'">
                    <i class="fas fa-images"></i>
                    –ú–æ—è –∫–æ–ª–ª–µ–∫—Ü–∏—è
                </button>
                <button class="btn btn-secondary" onclick="window.location.href='marketplace.html'">
                    <i class="fas fa-store"></i>
                    –ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å
                </button>
                <button class="btn btn-secondary" onclick="showCollectionStats()">
                    <i class="fas fa-chart-bar"></i>
                    –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                </button>
            </div>
        </div>
    </main>

    <!-- –û—Ç–∫—Ä—ã–≤–∞–µ–º pack -->
    <div id="pack-opening-modal" class="modal pack-modal" style="display: none;">
        <div class="pack-opening-container">
            <div class="pack-opening-stage">
                <!-- –≠—Ç–∞–ø 1: –û—Ç–∫—Ä—ã–≤–∞–µ–º —É–ø–∞–∫–æ–≤–∫—É -->
                <div id="pack-to-open" class="pack-card-large">
                    <div class="pack-content">
                        <div class="pack-icon-large">
                            <i id="pack-icon-display" class="fas fa-gift"></i>
                        </div>
                        <h3 id="pack-title">Starter Pack</h3>
                        <p class="pack-subtitle">–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å!</p>
                        <div class="pack-shimmer"></div>
                    </div>
                </div>

                <!-- <!- –≠—Ç–∞–ø 2: –ê–Ω–∏–º–∞—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è -> -->
                <div id="opening-animation" class="opening-animation" style="display: none;">
                    <div class="opening-text">–û—Ç–∫—Ä—ã–≤–∞–µ–º –ø–∞–∫...</div>
                    <div class="opening-spinner"></div>
                </div>

                <div id="revealed-cards" class="revealed-cards" style="display: none;">
                </div>

                <!-- Controls -->
                <div class="pack-opening-controls" style="display: none;">
                    <button class="btn btn-primary" onclick="closePackModal()">
                        <i class="fas fa-check"></i>
                        –ó–∞–±—Ä–∞—Ç—å –≤ –∫–æ–ª–ª–µ–∫—Ü–∏—é
                    </button>
                    <button class="btn btn-secondary" onclick="openAnotherPack()">
                        <i class="fas fa-redo"></i>
                        –û—Ç–∫—Ä—ã—Ç—å –µ—â–µ –ø–∞–∫
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Collection Stats Modal -->
    <div id="stats-modal" class="modal" style="display: none;">
        <div class="modal-content stats-content">
            <div class="modal-header">
                <h3><i class="fas fa-chart-bar"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–ª–ª–µ–∫—Ü–∏–∏</h3>
                <button onclick="closeStatsModal()" class="close-btn">√ó</button>
            </div>
            <div class="stats-grid">
                <div class="stat-card">
                    <h4>–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ</h4>
                    <div class="stat-number" id="stats-total">0</div>
                </div>
                <div class="stat-card">
                    <h4>–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å</h4>
                    <div class="stat-number" id="stats-value">0.000 SOL</div>
                </div>
                <div class="stat-card">
                    <h4>–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∞—Ä—Ç–∏—Å—Ç–æ–≤</h4>
                    <div class="stat-number" id="stats-artists">0</div>
                </div>
            </div>
            <div class="rarity-breakdown">
                <h4>–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ä–µ–¥–∫–æ—Å—Ç–∏:</h4>
                <div id="rarity-stats"></div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>
    <script src="js/config.js"></script>
    <script src="js/wallet.js"></script>
    <script src="js/rarity-manager.js"></script>
    <script src="js/pack-manager.js"></script>
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', () => {
            updateStats();
            loadPackStats();
        });

        function updateStats() {
            const stats = packManager.getCollectionStats();

            document.getElementById('user-collection-size').textContent = stats.totalNFTs;
            document.getElementById('collection-value').textContent = stats.totalValue.toFixed(3);

            // –û–±–Ω–æ–≤–ª—è–µ–º –æ–±—â—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            const totalPacksSold = localStorage.getItem('totalPacksSold') || '0';
            document.getElementById('total-packs-sold').textContent = totalPacksSold;
        }

        function loadPackStats() {
        }

        function showCollectionStats() {
            const stats = packManager.getCollectionStats();

            document.getElementById('stats-total').textContent = stats.totalNFTs;
            document.getElementById('stats-value').textContent = stats.totalValue.toFixed(3) + ' SOL';
            document.getElementById('stats-artists').textContent = stats.uniqueArtists;

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ä–µ–¥–∫–æ—Å—Ç–∏
            const rarityStats = document.getElementById('rarity-stats');
            rarityStats.innerHTML = Object.entries(stats.rarityBreakdown)
                .map(([rarity, count]) => {
                    const config = rarityManager.getRarityConfig(rarity);
                    return `
                        <div class="rarity-stat-item">
                            <div class="rarity-color" style="background: ${config.color}"></div>
                            <span>${config.name}: ${count}</span>
                        </div>
                    `;
                }).join('');

            document.getElementById('stats-modal').style.display = 'flex';
        }

        function closeStatsModal() {
            document.getElementById('stats-modal').style.display = 'none';
        }
    </script>
</body>

</html>